<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Saturday, December 23, 2017, 11:46 AM -->
<!-- MuClient version 5.04 -->

<!-- Plugin "AlignWindow" generated by Plugin Wizard -->

<muclient>
<plugin
   name="AlignWindow"
   author="Ruhsbaar"
   id="942aa4aa70e31ac872a10f74"
   language="Lua"
   purpose="Show alignment in a window"
   save_state="y"
   date_written="2017-12-23 11:45:32"
   requires="5.04"
   version="1.0"
   >

</plugin>


<!--  Get our standard constants -->

<include name="constants.lua"/>

<!--  Triggers  -->

<triggers>
  <trigger
   enabled="y"
   match="^\&lt;\&lt;\&lt; ([\w\s]+) \&gt;\&gt;\&gt;$"
   omit_from_output="y"
   regexp="y"
   send_to="12"
   sequence="100"
   script="RefreshAlignmentWindow"
  >
  <send>SetVariable("last_alignment", "%1")</send>
  </trigger>
  <trigger
   enabled="y"
   match="^Hp\: \d{2,4}\(\d{2,4}\)  Gp\: \d{2,4}\(\d{2,4}\)  Xp\: \d{1,10}  Burden\: \d{1,3}\%  Align\: ([\w\s]+)$"
   regexp="y"
   send_to="12"
   sequence="100"
   script="RefreshAlignmentWindow"
  >
  <send>SetVariable("last_alignment", "%1")</send>
  </trigger>
</triggers>

<!--  Variables  -->

<variables>
  <variable name="last_alignment"></variable>
</variables>

<!-- Script -->
<script>
    <![CDATA[
function RefreshAlignmentWindow() 
    align = GetVariable("last_alignment")

    -- Create a miniwindow
    win = "win_" .. GetPluginID()
    WindowCreate(
        win,
        0, 0,
        200, 50,
        miniwin.pos_bottom_right,
        miniwin.create_transparent,
        ColourNameToRGB("black")
    )

    -- Draw Borders
    WindowRectOp(win, miniwin.rect_frame, 0, 0, 200, 50, ColourNameToRGB("white"))

    -- Write alignment to window
    WindowFont (win, "f", "Trebuchet MS", 12, true, false, false, false) -- define font
    width   = WindowTextWidth (win, "f", align)
    left = (200 - width) / 2

    WindowText(win, "f", GetVariable("last_alignment"), left, 15, 0, 0, ColourNameToRGB("white"), false)

    -- Show the window on screen
    WindowShow(win, true)
end

RefreshAlignmentWindow()
    ]]>
</script>

</muclient>
